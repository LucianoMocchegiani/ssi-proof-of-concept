{"version":3,"file":"algorithm.mjs","names":[],"sources":["../../../../src/modules/kms/cose/algorithm.ts"],"sourcesContent":["import { z } from 'zod'\n\nexport const KnownCoseSignatureAlgorithms = {\n  // EdDSA algorithms - RFC 9864 Section 2.2\n  Ed25519: -19,\n  Ed448: -53,\n\n  // Deprecated polymorphic EdDSA - RFC 9864 Section 4.1.2\n  // Maps to Ed25519 as it's the most common use case (similar to WebAuthn's approach)\n  EdDSA: -19,\n\n  // ECDSA algorithms - RFC 9864 Section 2.1\n  // JOSE ES256/ES384/ES512 map to fully-specified COSE ESP256/ESP384/ESP512\n  ESP256: -9, // COSE ESP256 (ECDSA using P-256 curve and SHA-256)\n  ESP384: -51, // COSE ESP384 (ECDSA using P-384 curve and SHA-384)\n  ESP512: -52, // COSE ESP512 (ECDSA using P-521 curve and SHA-512)\n  ES256K: -47, // ECDSA using secp256k1 curve and SHA-256\n\n  // RSA algorithms - RFC 7518\n  RS256: -257, // RSASSA-PKCS1-v1_5 using SHA-256\n  RS384: -258, // RSASSA-PKCS1-v1_5 using SHA-384\n  RS512: -259, // RSASSA-PKCS1-v1_5 using SHA-512\n  PS256: -37, // RSASSA-PSS using SHA-256 and MGF1 with SHA-256\n  PS384: -38, // RSASSA-PSS using SHA-384 and MGF1 with SHA-384\n  PS512: -39, // RSASSA-PSS using SHA-512 and MGF1 with SHA-512\n} as const\n\nexport const zKnownCoseSignatureAlgorithm = z.enum(KnownCoseSignatureAlgorithms)\nexport type KnownCoseSignatureAlgorithm = z.output<typeof zKnownCoseSignatureAlgorithm>\n\nexport function isKnownCoseSignatureAlgorithm(coseAlg: number): coseAlg is KnownCoseSignatureAlgorithm {\n  return Object.values(KnownCoseSignatureAlgorithms).includes(coseAlg as KnownCoseSignatureAlgorithm)\n}\n"],"mappings":";;;;;AAEA,MAAa,+BAA+B;CAE1C,SAAS;CACT,OAAO;CAIP,OAAO;CAIP,QAAQ;CACR,QAAQ;CACR,QAAQ;CACR,QAAQ;CAGR,OAAO;CACP,OAAO;CACP,OAAO;CACP,OAAO;CACP,OAAO;CACP,OAAO;CACR;AAED,MAAa,+BAA+B,EAAE,KAAK,6BAA6B"}