{"version":3,"file":"legacy.mjs","names":[],"sources":["../../../src/modules/kms/legacy.ts"],"sourcesContent":["import { TypedArrayEncoder } from '../../utils'\nimport { KeyManagementError } from './error/KeyManagementError'\nimport { PublicJwk } from './jwk'\n\n/**\n * Returns the legacy key id based on the public key encoded as base58\n *\n * This is what was has been used by askar\n */\nexport function legacyKeyIdFromPublicJwk(publicJwk: PublicJwk) {\n  // Compressed public keys were used for legacy key ids\n  const compresedPublicKey = publicJwk.compressedPublicKey\n  if (compresedPublicKey) {\n    return TypedArrayEncoder.toBase58(compresedPublicKey.publicKey)\n  }\n\n  const publicKey = publicJwk.publicKey\n  if (publicKey.kty === 'RSA') {\n    throw new KeyManagementError(\n      'Unable to derive legacy key id from RSA key. Support for RSA keys was only added after explit key ids were added.'\n    )\n  }\n\n  return TypedArrayEncoder.toBase58(publicKey.publicKey)\n}\n"],"mappings":";;;;;;;;;;;;;AASA,SAAgB,yBAAyB,WAAsB;CAE7D,MAAM,qBAAqB,UAAU;AACrC,KAAI,mBACF,QAAO,kBAAkB,SAAS,mBAAmB,UAAU;CAGjE,MAAM,YAAY,UAAU;AAC5B,KAAI,UAAU,QAAQ,MACpB,OAAM,IAAI,mBACR,oHACD;AAGH,QAAO,kBAAkB,SAAS,UAAU,UAAU"}