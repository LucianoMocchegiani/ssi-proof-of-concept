

import { CredoError } from "../../../../error/CredoError.mjs";
import "../../../../error/index.mjs";
import { PublicJwk } from "../../../kms/jwk/PublicJwk.mjs";
import "../../../kms/index.mjs";
import { parseDid } from "../../domain/parse.mjs";
import { getDidDocumentForPublicJwk } from "../../domain/keyDidDocument.mjs";
import { PeerDidNumAlgo, getNumAlgoFromPeerDid, isValidPeerDid } from "./didPeer.mjs";

//#region src/modules/dids/methods/peer/peerDidNumAlgo0.ts
function publicJwkToNumAlgo0DidDocument(publicJwk) {
	return getDidDocumentForPublicJwk(`did:peer:0${publicJwk.fingerprint}`, publicJwk);
}
function didToNumAlgo0DidDocument(did) {
	const parsed = parseDid(did);
	const numAlgo = getNumAlgoFromPeerDid(did);
	if (!isValidPeerDid(did)) throw new CredoError(`Invalid peer did '${did}'`);
	if (numAlgo !== PeerDidNumAlgo.InceptionKeyWithoutDoc) throw new CredoError(`Invalid numAlgo ${numAlgo}, expected ${PeerDidNumAlgo.InceptionKeyWithoutDoc}`);
	return getDidDocumentForPublicJwk(did, PublicJwk.fromFingerprint(parsed.id.substring(1)));
}

//#endregion
export { didToNumAlgo0DidDocument, publicJwkToNumAlgo0DidDocument };
//# sourceMappingURL=peerDidNumAlgo0.mjs.map