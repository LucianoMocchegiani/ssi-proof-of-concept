{"version":3,"file":"JwsTypes.mjs","names":[],"sources":["../../src/crypto/JwsTypes.ts"],"sourcesContent":["import { type Jwk, type KnownJwaSignatureAlgorithm, PublicJwk } from '../modules/kms'\n\nexport type Kid = string\n\nexport interface JwsProtectedHeaderOptions {\n  alg: KnownJwaSignatureAlgorithm\n  kid?: Kid\n  jwk?: PublicJwk | Jwk\n  x5c?: string[]\n  [key: string]: unknown\n}\n\nexport interface JwsGeneralFormat {\n  /**\n   * unprotected header\n   */\n  header: Record<string, unknown>\n\n  /**\n   * Base64url encoded signature\n   */\n  signature: string\n\n  /**\n   * Base64url encoded protected header\n   */\n  protected: string\n\n  /**\n   * Base64url encoded payload\n   */\n  payload: string\n}\n\nexport interface JwsFlattenedFormat {\n  /**\n   * Base64url encoded payload\n   */\n  payload: string\n\n  /**\n   * List of JWS signatures over the payload\n   *\n   * The items in this array do not contain the payload.\n   */\n  signatures: JwsDetachedFormat[]\n}\n\n/**\n * JWS Compact Serialization\n *\n * @see https://tools.ietf.org/html/rfc7515#section-7.1\n */\nexport type JwsCompactFormat = string\n\nexport type Jws = JwsGeneralFormat | JwsFlattenedFormat | JwsCompactFormat\n\n// Detached JWS (does not contain payload)\nexport type JwsDetachedFormat = Omit<JwsGeneralFormat, 'payload'>\nexport interface JwsFlattenedDetachedFormat {\n  signatures: JwsDetachedFormat[]\n}\n\nexport const JWS_COMPACT_FORMAT_MATCHER = /^[A-Za-z0-9-_=]+\\.[A-Za-z0-9-_=]+\\.?[A-Za-z0-9-_.+/=]*$/\n"],"mappings":";;;;;AA+DA,MAAa,6BAA6B"}