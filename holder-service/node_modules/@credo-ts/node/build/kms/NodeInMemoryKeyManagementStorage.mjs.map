{"version":3,"file":"NodeInMemoryKeyManagementStorage.mjs","names":[],"sources":["../../src/kms/NodeInMemoryKeyManagementStorage.ts"],"sourcesContent":["import type { AgentContext, Kms } from '@credo-ts/core'\nimport type { NodeKeyManagementStorage } from './NodeKeyManagementStorage'\n\nexport class NodeInMemoryKeyManagementStorage implements NodeKeyManagementStorage {\n  #storage = new Map<string, Map<string, Kms.KmsJwkPrivate>>()\n\n  public async get(agentContext: AgentContext, keyId: string) {\n    return this.storageForContext(agentContext).get(keyId) ?? null\n  }\n\n  public has(agentContext: AgentContext, keyId: string) {\n    return this.storageForContext(agentContext).has(keyId)\n  }\n\n  public set(agentContext: AgentContext, keyId: string, jwk: Kms.KmsJwkPrivate) {\n    this.storageForContext(agentContext).set(keyId, jwk)\n  }\n\n  public delete(agentContext: AgentContext, keyId: string) {\n    return this.storageForContext(agentContext).delete(keyId)\n  }\n\n  private storageForContext(agentContext: AgentContext) {\n    let storage = this.#storage.get(agentContext.contextCorrelationId)\n\n    if (!storage) {\n      storage = new Map()\n      this.#storage.set(agentContext.contextCorrelationId, storage)\n    }\n\n    return storage\n  }\n}\n"],"mappings":";;;;;AAGA,IAAa,mCAAb,MAAkF;;6DACrE,IAAI,KAA6C;;CAE5D,MAAa,IAAI,cAA4B,OAAe;AAC1D,SAAO,KAAK,kBAAkB,aAAa,CAAC,IAAI,MAAM,IAAI;;CAG5D,AAAO,IAAI,cAA4B,OAAe;AACpD,SAAO,KAAK,kBAAkB,aAAa,CAAC,IAAI,MAAM;;CAGxD,AAAO,IAAI,cAA4B,OAAe,KAAwB;AAC5E,OAAK,kBAAkB,aAAa,CAAC,IAAI,OAAO,IAAI;;CAGtD,AAAO,OAAO,cAA4B,OAAe;AACvD,SAAO,KAAK,kBAAkB,aAAa,CAAC,OAAO,MAAM;;CAG3D,AAAQ,kBAAkB,cAA4B;EACpD,IAAI,2CAAU,KAAa,CAAC,IAAI,aAAa,qBAAqB;AAElE,MAAI,CAAC,SAAS;AACZ,6BAAU,IAAI,KAAK;AACnB,yCAAa,CAAC,IAAI,aAAa,sBAAsB,QAAQ;;AAG/D,SAAO"}