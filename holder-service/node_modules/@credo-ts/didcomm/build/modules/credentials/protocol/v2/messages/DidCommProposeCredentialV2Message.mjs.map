{"version":3,"file":"DidCommProposeCredentialV2Message.mjs","names":[],"sources":["../../../../../../src/modules/credentials/protocol/v2/messages/DidCommProposeCredentialV2Message.ts"],"sourcesContent":["import { Expose, Type } from 'class-transformer'\nimport { IsArray, IsInstance, IsOptional, IsString, ValidateNested } from 'class-validator'\n\nimport { DidCommMessage } from '../../../../../DidCommMessage'\nimport { DidCommAttachment } from '../../../../../decorators/attachment/DidCommAttachment'\nimport { IsValidMessageType, parseMessageType } from '../../../../../util/messageType'\nimport { DidCommCredentialFormatSpec } from '../../../models'\n\nimport { DidCommCredentialV2Preview } from './DidCommCredentialV2Preview'\n\nexport interface DidCommProposeCredentialV2MessageOptions {\n  id?: string\n  formats: DidCommCredentialFormatSpec[]\n  proposalAttachments: DidCommAttachment[]\n  comment?: string\n  goalCode?: string\n  goal?: string\n  credentialPreview?: DidCommCredentialV2Preview\n  attachments?: DidCommAttachment[]\n}\n\nexport class DidCommProposeCredentialV2Message extends DidCommMessage {\n  public constructor(options: DidCommProposeCredentialV2MessageOptions) {\n    super()\n    if (options) {\n      this.id = options.id ?? this.generateId()\n      this.comment = options.comment\n      this.goalCode = options.goalCode\n      this.goal = options.goal\n      this.credentialPreview = options.credentialPreview\n      this.formats = options.formats\n      this.proposalAttachments = options.proposalAttachments\n      this.appendedAttachments = options.attachments\n    }\n  }\n\n  @Type(() => DidCommCredentialFormatSpec)\n  @ValidateNested({ each: true })\n  @IsArray()\n  @IsInstance(DidCommCredentialFormatSpec, { each: true })\n  public formats!: DidCommCredentialFormatSpec[]\n\n  @IsValidMessageType(DidCommProposeCredentialV2Message.type)\n  public readonly type = DidCommProposeCredentialV2Message.type.messageTypeUri\n  public static readonly type = parseMessageType('https://didcomm.org/issue-credential/2.0/propose-credential')\n\n  @Expose({ name: 'credential_preview' })\n  @Type(() => DidCommCredentialV2Preview)\n  @ValidateNested()\n  @IsOptional()\n  @IsInstance(DidCommCredentialV2Preview)\n  public credentialPreview?: DidCommCredentialV2Preview\n\n  @Expose({ name: 'filters~attach' })\n  @Type(() => DidCommAttachment)\n  @IsArray()\n  @ValidateNested({\n    each: true,\n  })\n  @IsInstance(DidCommAttachment, { each: true })\n  public proposalAttachments!: DidCommAttachment[]\n\n  /**\n   * Human readable information about this Credential Proposal,\n   * so the proposal can be evaluated by human judgment.\n   */\n  @IsOptional()\n  @IsString()\n  public comment?: string\n\n  @Expose({ name: 'goal_code' })\n  @IsString()\n  @IsOptional()\n  public goalCode?: string\n\n  @IsString()\n  @IsOptional()\n  public goal?: string\n\n  public getProposalAttachmentById(id: string): DidCommAttachment | undefined {\n    return this.proposalAttachments.find((attachment) => attachment.id === id)\n  }\n}\n"],"mappings":";;;;;;;;;;;;;AAqBA,IAAa,oCAAb,MAAa,0CAA0C,eAAe;CACpE,AAAO,YAAY,SAAmD;AACpE,SAAO;OAoBO,OAAO,kCAAkC,KAAK;AAnB5D,MAAI,SAAS;AACX,QAAK,KAAK,QAAQ,MAAM,KAAK,YAAY;AACzC,QAAK,UAAU,QAAQ;AACvB,QAAK,WAAW,QAAQ;AACxB,QAAK,OAAO,QAAQ;AACpB,QAAK,oBAAoB,QAAQ;AACjC,QAAK,UAAU,QAAQ;AACvB,QAAK,sBAAsB,QAAQ;AACnC,QAAK,sBAAsB,QAAQ;;;CA+CvC,AAAO,0BAA0B,IAA2C;AAC1E,SAAO,KAAK,oBAAoB,MAAM,eAAe,WAAW,OAAO,GAAG;;;kCApCrD,OAAO,iBAAiB,8DAA8D;;CAR5G,WAAW,4BAA4B;CACvC,eAAe,EAAE,MAAM,MAAM,CAAC;CAC9B,SAAS;CACT,WAAW,6BAA6B,EAAE,MAAM,MAAM,CAAC;;;YAGvD,mBAAmB,kCAAkC,KAAK;;CAI1D,OAAO,EAAE,MAAM,sBAAsB,CAAC;CACtC,WAAW,2BAA2B;CACtC,gBAAgB;CAChB,YAAY;CACZ,WAAW,2BAA2B;;;;CAGtC,OAAO,EAAE,MAAM,kBAAkB,CAAC;CAClC,WAAW,kBAAkB;CAC7B,SAAS;CACT,eAAe,EACd,MAAM,MACP,CAAC;CACD,WAAW,mBAAmB,EAAE,MAAM,MAAM,CAAC;;;;CAO7C,YAAY;CACZ,UAAU;;;;CAGV,OAAO,EAAE,MAAM,aAAa,CAAC;CAC7B,UAAU;CACV,YAAY;;;;CAGZ,UAAU;CACV,YAAY"}