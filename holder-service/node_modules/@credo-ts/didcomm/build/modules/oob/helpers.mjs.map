{"version":3,"file":"helpers.mjs","names":[],"sources":["../../../src/modules/oob/helpers.ts"],"sourcesContent":["import {\n  createPeerDidDocumentFromServices,\n  DidCommV1Service,\n  DidDocumentBuilder,\n  DidKey,\n  didDocumentToNumAlgo2Did,\n  didKeyToEd25519PublicJwk,\n} from '@credo-ts/core'\nimport type { OutOfBandDidCommService } from './domain/OutOfBandDidCommService'\n\n// This method is kept to support searching for existing connections created by\n// credo-ts <= 0.5.1\n// TODO: Remove in 0.6.0 (when DidCommConnectionRecord.invitationDid will be migrated)\nexport function outOfBandServiceToInlineKeysNumAlgo2Did(service: OutOfBandDidCommService) {\n  const didDocument = new DidDocumentBuilder('')\n    .addService(\n      new DidCommV1Service({\n        id: service.id,\n        serviceEndpoint: service.serviceEndpoint,\n        accept: service.accept,\n        recipientKeys: service.recipientKeys.map((recipientKey) => {\n          const did = DidKey.fromDid(recipientKey)\n          return `${did.did}#${did.publicJwk.fingerprint}`\n        }),\n        // Map did:key:xxx to actual did:key:xxx#123\n        routingKeys: service.routingKeys?.map((routingKey) => {\n          const did = DidKey.fromDid(routingKey)\n          return `${did.did}#${did.publicJwk.fingerprint}`\n        }),\n      })\n    )\n    .build()\n\n  const did = didDocumentToNumAlgo2Did(didDocument)\n\n  return did\n}\n\nexport function outOfBandServiceToNumAlgo2Did(service: OutOfBandDidCommService) {\n  const { didDocument } = createPeerDidDocumentFromServices(\n    [\n      {\n        id: service.id,\n        recipientKeys: service.recipientKeys.map(didKeyToEd25519PublicJwk),\n        serviceEndpoint: service.serviceEndpoint,\n        routingKeys: service.routingKeys?.map(didKeyToEd25519PublicJwk) ?? [],\n      },\n    ],\n    false\n  )\n\n  const did = didDocumentToNumAlgo2Did(didDocument)\n\n  return did\n}\n"],"mappings":";;;AAaA,SAAgB,wCAAwC,SAAkC;AAsBxF,QAFY,yBAnBQ,IAAI,mBAAmB,GAAG,CAC3C,WACC,IAAI,iBAAiB;EACnB,IAAI,QAAQ;EACZ,iBAAiB,QAAQ;EACzB,QAAQ,QAAQ;EAChB,eAAe,QAAQ,cAAc,KAAK,iBAAiB;GACzD,MAAM,MAAM,OAAO,QAAQ,aAAa;AACxC,UAAO,GAAG,IAAI,IAAI,GAAG,IAAI,UAAU;IACnC;EAEF,aAAa,QAAQ,aAAa,KAAK,eAAe;GACpD,MAAM,MAAM,OAAO,QAAQ,WAAW;AACtC,UAAO,GAAG,IAAI,IAAI,GAAG,IAAI,UAAU;IACnC;EACH,CAAC,CACH,CACA,OAAO,CAEuC;;AAKnD,SAAgB,8BAA8B,SAAkC;CAC9E,MAAM,EAAE,gBAAgB,kCACtB,CACE;EACE,IAAI,QAAQ;EACZ,eAAe,QAAQ,cAAc,IAAI,yBAAyB;EAClE,iBAAiB,QAAQ;EACzB,aAAa,QAAQ,aAAa,IAAI,yBAAyB,IAAI,EAAE;EACtE,CACF,EACD,MACD;AAID,QAFY,yBAAyB,YAAY"}