{"version":3,"file":"DidCommMediationRequestHandler.mjs","names":[],"sources":["../../../../src/modules/routing/handlers/DidCommMediationRequestHandler.ts"],"sourcesContent":["import type { DidCommMessageHandler, DidCommMessageHandlerInboundMessage } from '../../../handlers'\nimport { DidCommOutboundMessageContext } from '../../../models'\nimport type { DidCommMediatorModuleConfig } from '../DidCommMediatorModuleConfig'\nimport { DidCommMediationRequestMessage } from '../messages/DidCommMediationRequestMessage'\nimport type { DidCommMediatorService } from '../services/DidCommMediatorService'\n\nexport class DidCommMediationRequestHandler implements DidCommMessageHandler {\n  private mediatorService: DidCommMediatorService\n  private mediatorModuleConfig: DidCommMediatorModuleConfig\n  public supportedMessages = [DidCommMediationRequestMessage]\n\n  public constructor(mediatorService: DidCommMediatorService, mediatorModuleConfig: DidCommMediatorModuleConfig) {\n    this.mediatorService = mediatorService\n    this.mediatorModuleConfig = mediatorModuleConfig\n  }\n\n  public async handle(messageContext: DidCommMessageHandlerInboundMessage<DidCommMediationRequestHandler>) {\n    const connection = messageContext.assertReadyConnection()\n\n    const mediationRecord = await this.mediatorService.processMediationRequest(messageContext)\n\n    if (this.mediatorModuleConfig.autoAcceptMediationRequests) {\n      const { message } = await this.mediatorService.createGrantMediationMessage(\n        messageContext.agentContext,\n        mediationRecord\n      )\n      return new DidCommOutboundMessageContext(message, {\n        agentContext: messageContext.agentContext,\n        connection,\n        associatedRecord: mediationRecord,\n      })\n    }\n  }\n}\n"],"mappings":";;;;;AAMA,IAAa,iCAAb,MAA6E;CAK3E,AAAO,YAAY,iBAAyC,sBAAmD;OAFxG,oBAAoB,CAAC,+BAA+B;AAGzD,OAAK,kBAAkB;AACvB,OAAK,uBAAuB;;CAG9B,MAAa,OAAO,gBAAqF;EACvG,MAAM,aAAa,eAAe,uBAAuB;EAEzD,MAAM,kBAAkB,MAAM,KAAK,gBAAgB,wBAAwB,eAAe;AAE1F,MAAI,KAAK,qBAAqB,6BAA6B;GACzD,MAAM,EAAE,YAAY,MAAM,KAAK,gBAAgB,4BAC7C,eAAe,cACf,gBACD;AACD,UAAO,IAAI,8BAA8B,SAAS;IAChD,cAAc,eAAe;IAC7B;IACA,kBAAkB;IACnB,CAAC"}