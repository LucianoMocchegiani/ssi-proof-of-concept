{"version":3,"file":"DidCommTrustPingService.mjs","names":[],"sources":["../../../../src/modules/connections/services/DidCommTrustPingService.ts"],"sourcesContent":["import { EventEmitter, injectable } from '@credo-ts/core'\nimport type { DidCommInboundMessageContext } from '../../../models'\nimport { DidCommOutboundMessageContext } from '../../../models'\nimport type { DidCommTrustPingReceivedEvent, TrustPingResponseReceivedEvent } from '../DidCommTrustPingEvents'\nimport { DidCommTrustPingEventTypes } from '../DidCommTrustPingEvents'\nimport type { DidCommTrustPingMessage } from '../messages'\nimport { DidCommTrustPingResponseMessage } from '../messages'\nimport type { DidCommConnectionRecord } from '../repository'\n\n@injectable()\nexport class DidCommTrustPingService {\n  private eventEmitter: EventEmitter\n\n  public constructor(eventEmitter: EventEmitter) {\n    this.eventEmitter = eventEmitter\n  }\n\n  public processPing(\n    { message, agentContext }: DidCommInboundMessageContext<DidCommTrustPingMessage>,\n    connection: DidCommConnectionRecord\n  ) {\n    this.eventEmitter.emit<DidCommTrustPingReceivedEvent>(agentContext, {\n      type: DidCommTrustPingEventTypes.DidCommTrustPingReceivedEvent,\n      payload: {\n        connectionRecord: connection,\n        message: message,\n      },\n    })\n\n    if (message.responseRequested) {\n      const response = new DidCommTrustPingResponseMessage({\n        threadId: message.threadId,\n      })\n\n      return new DidCommOutboundMessageContext(response, { agentContext, connection })\n    }\n  }\n\n  public processPingResponse(inboundMessage: DidCommInboundMessageContext<DidCommTrustPingResponseMessage>) {\n    const { agentContext, message } = inboundMessage\n\n    const connection = inboundMessage.assertReadyConnection()\n\n    this.eventEmitter.emit<TrustPingResponseReceivedEvent>(agentContext, {\n      type: DidCommTrustPingEventTypes.DidCommTrustPingResponseReceivedEvent,\n      payload: {\n        connectionRecord: connection,\n        message: message,\n      },\n    })\n  }\n}\n"],"mappings":";;;;;;;;;;;AAUO,oCAAM,wBAAwB;CAGnC,AAAO,YAAY,cAA4B;AAC7C,OAAK,eAAe;;CAGtB,AAAO,YACL,EAAE,SAAS,gBACX,YACA;AACA,OAAK,aAAa,KAAoC,cAAc;GAClE,MAAM,2BAA2B;GACjC,SAAS;IACP,kBAAkB;IACT;IACV;GACF,CAAC;AAEF,MAAI,QAAQ,kBAKV,QAAO,IAAI,8BAJM,IAAI,gCAAgC,EACnD,UAAU,QAAQ,UACnB,CAAC,EAEiD;GAAE;GAAc;GAAY,CAAC;;CAIpF,AAAO,oBAAoB,gBAA+E;EACxG,MAAM,EAAE,cAAc,YAAY;EAElC,MAAM,aAAa,eAAe,uBAAuB;AAEzD,OAAK,aAAa,KAAqC,cAAc;GACnE,MAAM,2BAA2B;GACjC,SAAS;IACP,kBAAkB;IACT;IACV;GACF,CAAC;;;sCAxCL,YAAY"}