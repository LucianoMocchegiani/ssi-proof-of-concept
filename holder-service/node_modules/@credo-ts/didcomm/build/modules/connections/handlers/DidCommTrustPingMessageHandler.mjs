import { DidCommDidExchangeState } from "../models/DidCommDidExchangeState.mjs";
import "../models/index.mjs";
import { DidCommTrustPingMessage } from "../messages/DidCommTrustPingMessage.mjs";
import "../messages/index.mjs";
import { CredoError } from "@credo-ts/core";

//#region src/modules/connections/handlers/DidCommTrustPingMessageHandler.ts
var DidCommTrustPingMessageHandler = class {
	constructor(trustPingService, connectionService) {
		this.supportedMessages = [DidCommTrustPingMessage];
		this.trustPingService = trustPingService;
		this.connectionService = connectionService;
	}
	async handle(messageContext) {
		const { connection, recipientKey } = messageContext;
		if (!connection) throw new CredoError(`Connection for verkey ${recipientKey?.fingerprint} not found!`);
		if (connection.state === DidCommDidExchangeState.ResponseSent) await this.connectionService.updateState(messageContext.agentContext, connection, DidCommDidExchangeState.Completed);
		return this.trustPingService.processPing(messageContext, connection);
	}
};

//#endregion
export { DidCommTrustPingMessageHandler };
//# sourceMappingURL=DidCommTrustPingMessageHandler.mjs.map