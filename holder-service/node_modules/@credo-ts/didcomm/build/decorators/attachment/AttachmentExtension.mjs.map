{"version":3,"file":"AttachmentExtension.mjs","names":[],"sources":["../../../src/decorators/attachment/AttachmentExtension.ts"],"sourcesContent":["import { Expose, Type } from 'class-transformer'\nimport { IsInstance, IsOptional, ValidateNested } from 'class-validator'\nimport type { BaseMessageConstructor } from '../../BaseDidCommMessage'\n\nimport { DidCommAttachment } from './DidCommAttachment'\n\nexport function AttachmentDecorated<T extends BaseMessageConstructor>(Base: T) {\n  class AttachmentDecoratorExtension extends Base {\n    /**\n     * The ~attach decorator is required for appending attachments to a message\n     */\n    @Expose({ name: '~attach' })\n    @Type(() => DidCommAttachment)\n    @ValidateNested()\n    @IsInstance(DidCommAttachment, { each: true })\n    @IsOptional()\n    public appendedAttachments?: DidCommAttachment[]\n\n    public getAppendedAttachmentById(id: string): DidCommAttachment | undefined {\n      return this.appendedAttachments?.find((attachment) => attachment.id === id)\n    }\n\n    public addAppendedAttachment(attachment: DidCommAttachment): void {\n      if (this.appendedAttachments) {\n        this.appendedAttachments.push(attachment)\n      } else {\n        this.appendedAttachments = [attachment]\n      }\n    }\n  }\n\n  return AttachmentDecoratorExtension\n}\n"],"mappings":";;;;;;;AAMA,SAAgB,oBAAsD,MAAS;CAC7E,MAAM,qCAAqC,KAAK;EAW9C,AAAO,0BAA0B,IAA2C;AAC1E,UAAO,KAAK,qBAAqB,MAAM,eAAe,WAAW,OAAO,GAAG;;EAG7E,AAAO,sBAAsB,YAAqC;AAChE,OAAI,KAAK,oBACP,MAAK,oBAAoB,KAAK,WAAW;OAEzC,MAAK,sBAAsB,CAAC,WAAW;;;;EAf1C,OAAO,EAAE,MAAM,WAAW,CAAC;EAC3B,WAAW,kBAAkB;EAC7B,gBAAgB;EAChB,WAAW,mBAAmB,EAAE,MAAM,MAAM,CAAC;EAC7C,YAAY;;;AAgBf,QAAO"}