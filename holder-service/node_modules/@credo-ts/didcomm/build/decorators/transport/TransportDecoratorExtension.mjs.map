{"version":3,"file":"TransportDecoratorExtension.mjs","names":[],"sources":["../../../src/decorators/transport/TransportDecoratorExtension.ts"],"sourcesContent":["import { Expose, Type } from 'class-transformer'\nimport { IsInstance, IsOptional, ValidateNested } from 'class-validator'\nimport type { BaseMessageConstructor } from '../../BaseDidCommMessage'\n\nimport { ReturnRouteTypes, TransportDecorator } from './TransportDecorator'\n\nexport function TransportDecorated<T extends BaseMessageConstructor>(Base: T) {\n  class TransportDecoratorExtension extends Base {\n    @Expose({ name: '~transport' })\n    @Type(() => TransportDecorator)\n    @ValidateNested()\n    @IsOptional()\n    @IsInstance(TransportDecorator)\n    public transport?: TransportDecorator\n\n    public setReturnRouting(type: ReturnRouteTypes, thread?: string) {\n      this.transport = new TransportDecorator({\n        returnRoute: type,\n        returnRouteThread: thread,\n      })\n    }\n\n    public hasReturnRouting(threadId?: string): boolean {\n      //   transport 'none' or undefined always false\n      if (!this.transport || !this.transport.returnRoute || this.transport.returnRoute === ReturnRouteTypes.none) {\n        return false\n      }\n      // transport 'all' always true\n      if (this.transport.returnRoute === ReturnRouteTypes.all) return true\n      // transport 'thread' with matching thread id is true\n      if (this.transport.returnRoute === ReturnRouteTypes.thread && this.transport.returnRouteThread === threadId)\n        return true\n\n      // transport is thread but threadId is either missing or doesn't match. Return false\n      return false\n    }\n\n    public hasAnyReturnRoute() {\n      const returnRoute = this.transport?.returnRoute\n      return returnRoute === ReturnRouteTypes.all || returnRoute === ReturnRouteTypes.thread\n    }\n  }\n\n  return TransportDecoratorExtension\n}\n"],"mappings":";;;;;;;AAMA,SAAgB,mBAAqD,MAAS;;CAC5E,MAAM,oCAAoC,KAAK;EAQ7C,AAAO,iBAAiB,MAAwB,QAAiB;AAC/D,QAAK,YAAY,IAAI,mBAAmB;IACtC,aAAa;IACb,mBAAmB;IACpB,CAAC;;EAGJ,AAAO,iBAAiB,UAA4B;AAElD,OAAI,CAAC,KAAK,aAAa,CAAC,KAAK,UAAU,eAAe,KAAK,UAAU,gBAAgB,iBAAiB,KACpG,QAAO;AAGT,OAAI,KAAK,UAAU,gBAAgB,iBAAiB,IAAK,QAAO;AAEhE,OAAI,KAAK,UAAU,gBAAgB,iBAAiB,UAAU,KAAK,UAAU,sBAAsB,SACjG,QAAO;AAGT,UAAO;;EAGT,AAAO,oBAAoB;GACzB,MAAM,cAAc,KAAK,WAAW;AACpC,UAAO,gBAAgB,iBAAiB,OAAO,gBAAgB,iBAAiB;;;;EA/BjF,OAAO,EAAE,MAAM,cAAc,CAAC;EAC9B,WAAW,mBAAmB;EAC9B,gBAAgB;EAChB,YAAY;EACZ,WAAW,mBAAmB;;;AA+BjC,QAAO"}