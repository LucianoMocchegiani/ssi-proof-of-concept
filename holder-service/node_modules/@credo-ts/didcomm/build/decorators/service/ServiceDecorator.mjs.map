{"version":3,"file":"ServiceDecorator.mjs","names":[],"sources":["../../../src/decorators/service/ServiceDecorator.ts"],"sourcesContent":["import type { ResolvedDidCommService } from '@credo-ts/core'\n\nimport { TypedArrayEncoder, utils, verkeyToPublicJwk } from '@credo-ts/core'\nimport { IsArray, IsOptional, IsString } from 'class-validator'\n\nexport interface ServiceDecoratorOptions {\n  recipientKeys: string[]\n  routingKeys?: string[]\n  serviceEndpoint: string\n}\n\n/**\n * Represents `~service` decorator\n *\n * Based on specification Aries RFC 0056: Service Decorator\n * @see https://github.com/hyperledger/aries-rfcs/tree/master/features/0056-service-decorator\n */\nexport class ServiceDecorator {\n  public constructor(options: ServiceDecoratorOptions) {\n    if (options) {\n      this.recipientKeys = options.recipientKeys\n      this.routingKeys = options.routingKeys\n      this.serviceEndpoint = options.serviceEndpoint\n    }\n  }\n\n  @IsArray()\n  @IsString({ each: true })\n  public recipientKeys!: string[]\n\n  @IsArray()\n  @IsString({ each: true })\n  @IsOptional()\n  public routingKeys?: string[]\n\n  @IsString()\n  public serviceEndpoint!: string\n\n  public get resolvedDidCommService(): ResolvedDidCommService {\n    return {\n      id: utils.uuid(),\n      recipientKeys: this.recipientKeys.map(verkeyToPublicJwk),\n      routingKeys: this.routingKeys?.map(verkeyToPublicJwk) ?? [],\n      serviceEndpoint: this.serviceEndpoint,\n    }\n  }\n\n  public static fromResolvedDidCommService(service: ResolvedDidCommService): ServiceDecorator {\n    return new ServiceDecorator({\n      recipientKeys: service.recipientKeys.map((k) => TypedArrayEncoder.toBase58(k.publicKey.publicKey)),\n      routingKeys: service.routingKeys.map((k) => TypedArrayEncoder.toBase58(k.publicKey.publicKey)),\n      serviceEndpoint: service.serviceEndpoint,\n    })\n  }\n}\n"],"mappings":";;;;;;;;;;;;AAiBA,IAAa,mBAAb,MAAa,iBAAiB;CAC5B,AAAO,YAAY,SAAkC;AACnD,MAAI,SAAS;AACX,QAAK,gBAAgB,QAAQ;AAC7B,QAAK,cAAc,QAAQ;AAC3B,QAAK,kBAAkB,QAAQ;;;CAgBnC,IAAW,yBAAiD;AAC1D,SAAO;GACL,IAAI,MAAM,MAAM;GAChB,eAAe,KAAK,cAAc,IAAI,kBAAkB;GACxD,aAAa,KAAK,aAAa,IAAI,kBAAkB,IAAI,EAAE;GAC3D,iBAAiB,KAAK;GACvB;;CAGH,OAAc,2BAA2B,SAAmD;AAC1F,SAAO,IAAI,iBAAiB;GAC1B,eAAe,QAAQ,cAAc,KAAK,MAAM,kBAAkB,SAAS,EAAE,UAAU,UAAU,CAAC;GAClG,aAAa,QAAQ,YAAY,KAAK,MAAM,kBAAkB,SAAS,EAAE,UAAU,UAAU,CAAC;GAC9F,iBAAiB,QAAQ;GAC1B,CAAC;;;;CA1BH,SAAS;CACT,SAAS,EAAE,MAAM,MAAM,CAAC;;;;CAGxB,SAAS;CACT,SAAS,EAAE,MAAM,MAAM,CAAC;CACxB,YAAY;;;YAGZ,UAAU"}