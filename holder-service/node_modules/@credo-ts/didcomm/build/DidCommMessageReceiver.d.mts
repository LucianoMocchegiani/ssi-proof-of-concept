import { DidCommEnvelopeService } from "./DidCommEnvelopeService.mjs";
import { DidCommConnectionService } from "./modules/connections/services/DidCommConnectionService.mjs";
import "./modules/connections/services/index.mjs";
import { DidCommMessageHandlerRegistry } from "./DidCommMessageHandlerRegistry.mjs";
import { DidCommTransportService, DidCommTransportSession } from "./DidCommTransportService.mjs";
import { DidCommMessageSender } from "./DidCommMessageSender.mjs";
import { DidCommConnectionRecord } from "./modules/connections/repository/DidCommConnectionRecord.mjs";
import "./modules/connections/repository/index.mjs";
import { DidCommDispatcher } from "./DidCommDispatcher.mjs";
import { AgentContextProvider, Logger } from "@credo-ts/core";

//#region src/DidCommMessageReceiver.d.ts
declare class DidCommMessageReceiver {
  private envelopeService;
  private transportService;
  private messageSender;
  private dispatcher;
  private logger;
  private connectionService;
  private messageHandlerRegistry;
  private agentContextProvider;
  constructor(envelopeService: DidCommEnvelopeService, transportService: DidCommTransportService, messageSender: DidCommMessageSender, connectionService: DidCommConnectionService, dispatcher: DidCommDispatcher, messageHandlerRegistry: DidCommMessageHandlerRegistry, agentContextProvider: AgentContextProvider, logger: Logger);
  /**
   * Receive and handle an inbound DIDComm message. It will determine the agent context, decrypt the message, transform it
   * to it's corresponding message class and finally dispatch it to the dispatcher.
   *
   * @param inboundMessage the message to receive and handle
   */
  receiveMessage(inboundMessage: unknown, {
    session,
    connection,
    contextCorrelationId,
    receivedAt
  }?: {
    session?: DidCommTransportSession;
    connection?: DidCommConnectionRecord;
    contextCorrelationId?: string;
    receivedAt?: Date;
  }): Promise<void>;
  private receivePlaintextMessage;
  private receiveEncryptedMessage;
  /**
   * Decrypt a message using the envelope service.
   *
   * @param message the received inbound message to decrypt
   */
  private decryptMessage;
  private isPlaintextMessage;
  private isEncryptedMessage;
  private transformAndValidate;
  private findConnectionByMessageKeys;
  /**
   * Transform an plaintext DIDComm message into it's corresponding message class. Will look at all message types in the registered handlers.
   *
   * @param message the plaintext message for which to transform the message in to a class instance
   */
  private transformMessage;
  /**
   * Send the problem report message (https://didcomm.org/notification/1.0/problem-report) to the recipient.
   * @param message error message to send
   * @param connection connection to send the message to
   * @param plaintextMessage received inbound message
   */
  private sendProblemReportMessage;
}
//#endregion
export { DidCommMessageReceiver };
//# sourceMappingURL=DidCommMessageReceiver.d.mts.map