{"version":3,"file":"DidCommFeature.mjs","names":[],"sources":["../../../src/models/features/DidCommFeature.ts"],"sourcesContent":["import { CredoError, JsonTransformer } from '@credo-ts/core'\nimport { Expose } from 'class-transformer'\nimport { IsString } from 'class-validator'\n\nexport interface DidCommFeatureOptions {\n  id: string\n  type: string\n}\n\nexport class DidCommFeature {\n  public id!: string\n\n  public constructor(props: DidCommFeatureOptions) {\n    if (props) {\n      this.id = props.id\n      this.type = props.type\n    }\n  }\n\n  @IsString()\n  @Expose({ name: 'feature-type' })\n  public readonly type!: string\n\n  /**\n   * Combine this feature with another one, provided both are from the same type\n   * and have the same id\n   *\n   * @param feature object to combine with this one\n   * @returns a new object resulting from the combination between this and feature\n   */\n  public combine(feature: this) {\n    if (feature.id !== this.id) {\n      throw new CredoError('Can only combine with a feature with the same id')\n    }\n\n    const obj1 = JsonTransformer.toJSON(this)\n    const obj2 = JsonTransformer.toJSON(feature)\n\n    for (const key in obj2) {\n      try {\n        if (Array.isArray(obj2[key])) {\n          obj1[key] = [...new Set([...obj1[key], ...obj2[key]])]\n        } else {\n          obj1[key] = obj2[key]\n        }\n      } catch (_e) {\n        obj1[key] = obj2[key]\n      }\n    }\n    return JsonTransformer.fromJSON(obj1, DidCommFeature)\n  }\n\n  public toJSON(): Record<string, unknown> {\n    return JsonTransformer.toJSON(this)\n  }\n}\n"],"mappings":";;;;;;;AASA,IAAa,iBAAb,MAAa,eAAe;CAG1B,AAAO,YAAY,OAA8B;AAC/C,MAAI,OAAO;AACT,QAAK,KAAK,MAAM;AAChB,QAAK,OAAO,MAAM;;;;;;;;;;CAetB,AAAO,QAAQ,SAAe;AAC5B,MAAI,QAAQ,OAAO,KAAK,GACtB,OAAM,IAAI,WAAW,mDAAmD;EAG1E,MAAM,OAAO,gBAAgB,OAAO,KAAK;EACzC,MAAM,OAAO,gBAAgB,OAAO,QAAQ;AAE5C,OAAK,MAAM,OAAO,KAChB,KAAI;AACF,OAAI,MAAM,QAAQ,KAAK,KAAK,CAC1B,MAAK,OAAO,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,KAAK,MAAM,GAAG,KAAK,KAAK,CAAC,CAAC;OAEtD,MAAK,OAAO,KAAK;WAEZ,IAAI;AACX,QAAK,OAAO,KAAK;;AAGrB,SAAO,gBAAgB,SAAS,MAAM,eAAe;;CAGvD,AAAO,SAAkC;AACvC,SAAO,gBAAgB,OAAO,KAAK;;;;CAlCpC,UAAU;CACV,OAAO,EAAE,MAAM,gBAAgB,CAAC"}